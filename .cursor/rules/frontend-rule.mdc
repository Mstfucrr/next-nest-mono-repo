---
globs: apps/web/**/*.ts,apps/web/**/*.tsx,apps/web/**/*.json,apps/web/**/*.css,apps/web/**/*.md
alwaysApply: false
---

<!--
Glob: apps/web/**/*.{ts,tsx,js,jsx,json,css,md}
-->

# ğŸ¨ FRONTEND (WEB) RULES

## ï¿½ï¿½ï¸ Proje YapÄ±sÄ±

```bash
apps/web/src/
src/
â”œâ”€â”€ app/                  # Sayfa yÃ¶nlendirmeleri, route gruplarÄ± ve UI bileÅŸenlerinin render edildiÄŸi ana klasÃ¶r.
â”œâ”€â”€ components/           # Tekrar kullanÄ±labilir genel bileÅŸenler.
â”œâ”€â”€ hooks/                # Tekrar kullanÄ±labilir global hooklar.
â”œâ”€â”€ services/             # API Ã§aÄŸrÄ±larÄ± iÃ§in global servis dosyalarÄ±.
â”œâ”€â”€ utils/                # Proje iÃ§inde tekrar kullanÄ±labilir, saf (pure) yardÄ±mcÄ± fonksiyonlar. Ã–rneÄŸin, tarih formatlama, metin dÃ¶nÃ¼ÅŸtÃ¼rme gibi baÄŸÄ±msÄ±z iÅŸlemler.
â”œâ”€â”€ lib/                  # Harici kÃ¼tÃ¼phaneler, Ã¶zel yapÄ±landÄ±rmalar ve proje genelinde kullanÄ±lan geniÅŸletilmiÅŸ utility fonksiyonlarÄ±. Ã–rneÄŸin, API isteÄŸi, `cn` gibi class yÃ¶netim fonksiyonlarÄ±, auth iÅŸlemleri vb.
â”œâ”€â”€ __test__/             # Test dosyalarÄ±nÄ±n konulduÄŸu klasÃ¶r. (opsiyonel)
â”œâ”€â”€ modules/              # ModÃ¼ler yapÄ±.
â”‚   â”œâ”€â”€ module1/
â”‚   â”‚   â”œâ”€â”€ hooks/        # ModÃ¼le1'e Ã¶zel hooklar.
â”‚   â”‚   â”œâ”€â”€ components/   # ModÃ¼le1'e Ã¶zel bileÅŸenler.
â”‚   â”‚   â”œâ”€â”€ utils/        # ModÃ¼le1'e Ã¶zel yardÄ±mcÄ± araÃ§lar.
â”‚   â”‚   â”œâ”€â”€ services/     # ModÃ¼le1'e Ã¶zel API servisleri.
â”‚   â”‚   â”œâ”€â”€ views/        # ModÃ¼le1'e Ã¶zel sayfalar.
â”‚   â”œâ”€â”€ module2/
â”‚   â””â”€â”€ ... module_n/
public/
â”œâ”€â”€ images/               # Ä°htiyaÃ§ halinde kullanÄ±lacak resimler.
â””â”€â”€ icons/                # Ä°htiyaÃ§ halinde kullanÄ±lacak ikonlar.
```

## ğŸ¯ Component KurallarÄ±

### Component YapÄ±sÄ±

```tsx
// âœ… DoÄŸru
interface UserCardProps {
  user: User
  onEdit?: (user: User) => void
  className?: string
}

export function UserCard({ user, onEdit, className }: UserCardProps) {
  return (
    <div className={cn('user-card', className)}>
      <h3>{user.name}</h3>
      <p>{user.email}</p>
      {onEdit && (
        <button onClick={() => onEdit(user)}>
          Edit
        </button>
      )}
    </div>
  )
}

// âŒ YanlÄ±ÅŸ
export default function UserCard(props: any) {
  return <div>{props.user.name}</div>
}
```

### Component Naming

```typescript
// âœ… DoÄŸru
UserProfile.tsx
ProductCard.tsx
NavigationMenu.tsx
useAuth.ts
useApi.ts
// service ve store iÃ§in âœ… DoÄŸru
user.service.ts
user.store.ts

// âŒ YanlÄ±ÅŸ
userProfile.tsx
product-card.tsx
nav.tsx
useauth.ts
```


### cn KullanÄ±mÄ±


AÅŸaÄŸÄ±ya `cn` kullanÄ±mÄ± iÃ§in **Frontend (WEB) Rules** dokÃ¼manÄ±na eklenebilecek kurallarÄ±, Ã¶rneklerle birlikte kÄ±sa ve net ÅŸekilde hazÄ±rladÄ±m:

---

## ğŸ¨ Styling KurallarÄ±

### âœ… **`cn` (classNames) KullanÄ±mÄ±**

Tailwind CSS ile `className` tanÄ±mlarÄ±nda koÅŸullu sÄ±nÄ±flarÄ± daha okunabilir hale getirmek iÃ§in `cn` (genellikle `clsx` veya `classnames` tÃ¼revi) kullanÄ±lmalÄ±dÄ±r. `lib/utils.ts` iÃ§inde tanÄ±mlÄ± olan `cn` fonksiyonu ÅŸu ÅŸekilde kullanÄ±lmalÄ±dÄ±r:

#### ğŸ“Œ DoÄŸru KullanÄ±m

```tsx
<div
  className={cn(
    'mb-2',
    {
      'text-red-500': hasError,
      'text-green-500': !hasError
    }
  )}
>
  Email
</div>
```

```tsx
// opsiyonel className prop'u olan bir bileÅŸende
export function Button({ className }: { className?: string }) {
  return (
    <button
      className={cn('px-4 py-2 rounded', className)}
    >
      GÃ¶nder
    </button>
  )
}
```

#### ğŸš« YanlÄ±ÅŸ KullanÄ±m

```tsx
// koÅŸulsuz string birleÅŸtirme
className={`px-4 py-2 rounded ${isError ? 'text-red-500' : ''}`}

// gereksiz string concat
className={'text-lg' + (active ? ' font-bold' : '')}

// className'e doÄŸrudan `clsx` yazmak
import clsx from 'clsx'
className={clsx('a', { b: true })} // âŒ cn kullanÄ±lmalÄ±
```

---

### âœ… Kurallar Ã–zeti

* `className` iÃ§inde koÅŸullu stil uygulanacaksa `cn()` kullanÄ±lmalÄ±.
* `cn()` iÃ§inde sabit sÄ±nÄ±flar string olarak, koÅŸullu sÄ±nÄ±flar `{ 'class-name': condition }` ÅŸeklinde yazÄ±lmalÄ±.
* `clsx` ya da `classnames` doÄŸrudan kullanÄ±lmamalÄ±, bunun yerine proje genelinde tanÄ±mlÄ± `cn()` fonksiyonu tercih edilmelidir.

### Props Interface

```typescript
// âœ… DoÄŸru
interface ButtonProps {
  children: React.ReactNode
  variant?: 'primary' | 'secondary' | 'danger'
  size?: 'sm' | 'md' | 'lg'
  disabled?: boolean
  onClick?: () => void
  className?: string
}

// âŒ YanlÄ±ÅŸ
interface ButtonProps {
  children: any
  variant: string
  onClick: any
}
```

## ğŸ¨ Styling KurallarÄ±

### Tailwind CSS KullanÄ±mÄ±

```tsx
// âœ… DoÄŸru
<div className="flex items-center justify-between p-4 bg-white rounded-lg shadow-md">
  <h2 className="text-xl font-semibold text-gray-900">
    User Profile
  </h2>
  <button className="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">
    Edit
  </button>
</div>

// âŒ YanlÄ±ÅŸ
<div className="flex items-center justify-between p-4 bg-white rounded-lg shadow-md text-xl font-semibold text-gray-900">
  User Profile
</div>
```

### CSS Module KullanÄ±mÄ± (Gerekirse)

```tsx
// âœ… DoÄŸru
import styles from './UserCard.module.css'

export const UserCard = () => {
  return (
    <div className={styles.card}>
      <h3 className={styles.title}>User Name</h3>
    </div>
  )
}
```

### Responsive Design

```tsx
// âœ… DoÄŸru
<div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
  <div className="p-4 bg-white rounded-lg">
    Content
  </div>
</div>

// âŒ YanlÄ±ÅŸ
<div className="grid grid-cols-3 gap-4">
  <div className="p-4 bg-white rounded-lg">
    Content
  </div>
</div>
```

## ğŸ”— State Management

### Local State (useState)

```typescript
// âœ… DoÄŸru
const [isLoading, setIsLoading] = useState(false)
const [user, setUser] = useState<User | null>(null)
const [error, setError] = useState<string | null>(null)

// âŒ YanlÄ±ÅŸ
const [state, setState] = useState({
  isLoading: false,
  user: null,
  error: null
})
```

### Custom Hooks

```typescript
// âœ… DoÄŸru
export function useAuth() {
  const [user, setUser] = useState<User | null>(null)
  const [isLoading, setIsLoading] = useState(true)

  async function login(credentials: LoginCredentials) {
    try {
      setIsLoading(true)
      const response = await authService.login(credentials)
      setUser(response.user)
    } catch (error) {
      throw error
    } finally {
      setIsLoading(false)
    }
  }

  return { user, isLoading, login }
}

// âŒ YanlÄ±ÅŸ
export const useAuth = () => {
  return {
    user: null,
    login: () => {}
  }
}
```

## ğŸŒ API Integration

### Service Functions

```typescript
// âœ… DoÄŸru
export const userService = {
  async getUsers(): Promise<User[]> {
    const response = await fetch('/api/users')
    if (!response.ok) {
      throw new Error('Failed to fetch users')
    }
    return response.json()
  },

  async createUser(userData: CreateUserData): Promise<User> {
    const response = await fetch('/api/users', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(userData)
    })
    if (!response.ok) {
      throw new Error('Failed to create user')
    }
    return response.json()
  }
}

// âŒ YanlÄ±ÅŸ
export const userService = {
  getUsers: () => fetch('/api/users').then(res => res.json()),
  createUser: (data: any) => fetch('/api/users', {
    method: 'POST',
    body: JSON.stringify(data)
  }).then(res => res.json())
}
```

### Error Handling

```typescript
// âœ… DoÄŸru
const [users, setUsers] = useState<User[]>([])
const [error, setError] = useState<string | null>(null)
const [isLoading, setIsLoading] = useState(false)

const fetchUsers = async () => {
  try {
    setIsLoading(true)
    setError(null)
    const data = await userService.getUsers()
    setUsers(data)
  } catch (err) {
    setError(err instanceof Error ? err.message : 'An error occurred')
  } finally {
    setIsLoading(false)
  }
}

// âŒ YanlÄ±ÅŸ
const fetchUsers = async () => {
  const data = await userService.getUsers()
  setUsers(data)
}
```

## ğŸ“ Form Handling

### React Hook Form

```typescript
// âœ… DoÄŸru
import { useForm } from 'react-hook-form'
import { zodResolver } from '@hookform/resolvers/zod'
import { z } from 'zod'

const userSchema = z.object({
  name: z.string().min(2, 'Name must be at least 2 characters'),
  email: z.string().email('Invalid email address'),
  age: z.number().min(18, 'Must be at least 18 years old')
})

type UserFormData = z.infer<typeof userSchema>

export const UserForm = () => {
  const {
    register,
    handleSubmit,
    formState: { errors, isSubmitting }
  } = useForm<UserFormData>({
    resolver: zodResolver(userSchema)
  })

  const onSubmit = async (data: UserFormData) => {
    try {
      await userService.createUser(data)
    } catch (error) {
      console.error('Failed to create user:', error)
    }
  }

  return (
    <form onSubmit={handleSubmit(onSubmit)}>
      <input {...register('name')} />
      {errors.name && <span>{errors.name.message}</span>}
      
      <input {...register('email')} />
      {errors.email && <span>{errors.email.message}</span>}
      
      <button type="submit" disabled={isSubmitting}>
        {isSubmitting ? 'Creating...' : 'Create User'}
      </button>
    </form>
  )
}

// âŒ YanlÄ±ÅŸ
export const UserForm = () => {
  const [name, setName] = useState('')
  const [email, setEmail] = useState('')

  const handleSubmit = (e: any) => {
    e.preventDefault()
    // Validation logic here
  }

  return (
    <form onSubmit={handleSubmit}>
      <input value={name} onChange={(e) => setName(e.target.value)} />
      <input value={email} onChange={(e) => setEmail(e.target.value)} />
      <button type="submit">Submit</button>
    </form>
  )
}
```

## ğŸ”’ Authentication & Authorization

### Protected Routes

```tsx
// âœ… DoÄŸru
export const ProtectedRoute: React.FC<{ children: React.ReactNode }> = ({
  children
}) => {
  const { user, isLoading } = useAuth()

  if (isLoading) {
    return <div>Loading...</div>
  }

  if (!user) {
    return <Navigate to="/login" replace />
  }

  return <>{children}</>
}

// âŒ YanlÄ±ÅŸ
export const ProtectedRoute = ({ children }: any) => {
  const user = localStorage.getItem('user')
  return user ? children : <div>Not authorized</div>
}
```

### Authorization HOC

```tsx
type Role = 'user' | 'seller' | 'admin' | 'godlike'

interface WithAuthorizationOptions {
  requiredRoles?: Role[]
  redirectTo?: string
}

export function withAuthorization<P extends object>(
  Component: React.ComponentType<P>,
  options?: WithAuthorizationOptions
): React.FC<P> {
  const { requiredRoles = [], redirectTo = '/login' } = options || {}

  return function AuthorizedComponent(props: P) {
    const { user, isLoading } = useAuth()
    const router = useRouter()

    useEffect(() => {
      if (!isLoading && (!user || (requiredRoles.length && !requiredRoles.includes(user.role)))) {
        router.replace(redirectTo)
      }
    }, [isLoading, user, requiredRoles, router, redirectTo])

    if (isLoading || !user) return <div className='p-4'>YÃ¼kleniyor...</div>
    if (requiredRoles.length && !requiredRoles.includes(user.role)) return null

    return <Component {...props} />
  }
}
```

## ğŸ§ª Testing

### Component Testing

```typescript
// âœ… DoÄŸru
import { render, screen, fireEvent } from '@testing-library/react'
import { UserCard } from './UserCard'

describe('UserCard', () => {
  const mockUser = {
    id: 1,
    name: 'John Doe',
    email: 'john@example.com'
  }

  it('renders user information correctly', () => {
    render(<UserCard user={mockUser} />)
    
    expect(screen.getByText('John Doe')).toBeInTheDocument()
    expect(screen.getByText('john@example.com')).toBeInTheDocument()
  })

  it('calls onEdit when edit button is clicked', () => {
    const mockOnEdit = jest.fn()
    render(<UserCard user={mockUser} onEdit={mockOnEdit} />)
    
    fireEvent.click(screen.getByText('Edit'))
    expect(mockOnEdit).toHaveBeenCalledWith(mockUser)
  })
})

// âŒ YanlÄ±ÅŸ
describe('UserCard', () => {
  it('works', () => {
    render(<UserCard />)
    expect(true).toBe(true)
  })
})
```

### Hook Testing

```typescript
// âœ… DoÄŸru
import { renderHook, act } from '@testing-library/react'
import { useAuth } from './useAuth'

describe('useAuth', () => {
  it('should handle login correctly', async () => {
    const { result } = renderHook(() => useAuth())

    await act(async () => {
      await result.current.login({
        email: 'test@example.com',
        password: 'password'
      })
    })

    expect(result.current.user).toBeDefined()
    expect(result.current.isLoading).toBe(false)
  })
})
```

## ğŸ“± Performance

### Memoization

```tsx
// âœ… DoÄŸru
export const UserList = React.memo(({ users }: { users: User[] }) => {
  return (
    <div>
      {users.map(user => (
        <UserCard key={user.id} user={user} />
      ))}
    </div>
  )
})

// âŒ YanlÄ±ÅŸ
export const UserList = ({ users }: { users: User[] }) => {
  return (
    <div>
      {users.map(user => (
        <UserCard key={user.id} user={user} />
      ))}
    </div>
  )
}
```

### Lazy Loading

```tsx
// âœ… DoÄŸru
const AdminPanel = lazy(() => import('./AdminPanel'))

export const App = () => {
  return (
    <Suspense fallback={<div>Loading...</div>}>
      <AdminPanel />
    </Suspense>
  )
}

// âŒ YanlÄ±ÅŸ
import AdminPanel from './AdminPanel'

export const App = () => {
  return <AdminPanel />
}
```

## ğŸ¨ UI/UX Guidelines

### Loading States

```tsx
// âœ… DoÄŸru
export const UserProfile = () => {
  const { user, isLoading, error } = useUser()

  if (isLoading) {
    return <div className="flex items-center justify-center p-8">
      <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"></div>
    </div>
  }

  if (error) {
    return <div className="text-red-500 p-4">{error}</div>
  }

  if (!user) {
    return <div className="text-gray-500 p-4">User not found</div>
  }

  return (
    <div className="p-4">
      <h1 className="text-2xl font-bold">{user.name}</h1>
      <p className="text-gray-600">{user.email}</p>
    </div>
  )
}
```

### Error Boundaries

```tsx
// âœ… DoÄŸru
export class ErrorBoundary extends React.Component<
  { children: React.ReactNode },
  { hasError: boolean }
> {
  constructor(props: { children: React.ReactNode }) {
    super(props)
    this.state = { hasError: false }
  }

  static getDerivedStateFromError(error: Error) {
    return { hasError: true }
  }

  componentDidCatch(error: Error, errorInfo: React.ErrorInfo) {
    console.error('Error caught by boundary:', error, errorInfo)
  }

  render() {
    if (this.state.hasError) {
      return (
        <div className="p-4 text-center">
          <h2 className="text-xl font-semibold text-red-600">
            Something went wrong
          </h2>
          <button
            onClick={() => this.setState({ hasError: false })}
            className="mt-2 px-4 py-2 bg-blue-500 text-white rounded"
          >
            Try again
          </button>
        </div>
      )
    }

    return this.props.children
  }
}
```

## ğŸ“Š Analytics & Monitoring

### Error Tracking

```typescript
// âœ… DoÄŸru
export const logError = (error: Error, context?: Record<string, any>) => {
  console.error('[ERROR]', {
    message: error.message,
    stack: error.stack,
    context,
    timestamp: new Date().toISOString()
  })
  
  // Send to error tracking service
  // Sentry.captureException(error, { extra: context })
}

// âŒ YanlÄ±ÅŸ
export const logError = (error: any) => {
  console.error(error)
}
```

### Performance Monitoring

```typescript
// âœ… DoÄŸru
export const usePerformanceMonitor = (componentName: string) => {
  useEffect(() => {
    const startTime = performance.now()
    
    return () => {
      const endTime = performance.now()
      console.log(`[PERF] ${componentName} render time: ${endTime - startTime}ms`)
    }
  })
}
```

## ğŸ”§ Development Tools

### VS Code Settings

```json
{
  "typescript.preferences.importModuleSpecifier": "relative",
  "editor.formatOnSave": true,
  "editor.defaultFormatter": "esbenp.prettier-vscode",
  "tailwindCSS.includeLanguages": {
    "typescript": "javascript",
    "typescriptreact": "javascript"
  }
}
```

### ESLint Rules

```json
{
  "rules": {
    "@typescript-eslint/no-explicit-any": "error",
    "@typescript-eslint/no-unused-vars": "error",
    "react-hooks/exhaustive-deps": "error",
    "react/prop-types": "off"
  }
}
```
